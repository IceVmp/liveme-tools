<!doctype html>
<html>
	<head>
		<title>Fans</title>

		<script>
			if (typeof module === 'object') {window.module = module; module = undefined;} 
		</script>

		<link rel="stylesheet" href="style/style.css">
		<script src="javascript/jquery-3.2.1.min.js"></script>

		<script>
			

			function closeApp() {
			    window.close()
			}

			function doFetch() {
			    var e = window.location.href.split("?")[1].split("#");
                userID = e[0];
                
                document.title = `${e[2]} - Fans`;

			    max = e[1], $.ajax({
			        url: "http://live.ksmobile.net/follow/getFollowerListShip",
			        data: {
			            page_size: ps,
			            page_index: cp,
			            access_token: userID
			        },
			        cache: !1,
			        type: "GET",
			        dataType: "json",
			        success: function(e) {
			            if (e.data.length > 0) {
			                for (i = 0; i < e.data.length; i++) {
			                	if (e.data[i].uid.length > 15) {
			                		var sex = e.data[i].sex < 0 ? '' : (e.data[i].sex == 0 ? 'female' : 'male');
									$("#small_user_list").append(`
										<div class="item small clickable" onClick="getVideos('${e.data[i].uid}')">
											<div class="avatar">
												<img src="${e.data[i].face}" class="${sex}" onerror="this.src='images/blank.png'">
											</div>
											<div class="content">
												<div class="header">${e.data[i].nickname}</div>
											</div>
										</div>
									`);
				                }
			                }
		                    cp++;
		                    doFetch();
			            }
			        }
			    })
			}

			function getVideos(e) {
				var {ipcRenderer} = require('electron')
				ipcRenderer.send('submit-search', { userid: e });
			}
			var ps = 20,
			    cp = 1,
			    ct = 0,
			    max = 0,
			    userID = "";
			$(function() {
				$('#small_user_list').html('');
			    setTimeout(function() {
			        doFetch();
			    }, 250);
			});

		</script>
		
	</head>
	<body>
		<main>
			<div class="list" id="small_user_list"></div>
		</main>
	</body>
</html>